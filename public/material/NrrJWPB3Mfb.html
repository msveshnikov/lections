<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body>
<p><span>Наследование до некоторой степени изменяет правила совместимости типов в Borland Pascal. Потомок наследует совместимость типов всех своих предков.</span></p>
<p><span>Эта расширенная совместимость типов принимает три формы:</span></p>
<p><span>1) между реализациями объектов;</span></p>
<p><span>2) между указателями на реализации объектов;</span></p>
<p><span>3) между формальными и фактическими параметрами. Совместимость типов расширяется только от потомка к родителю.</span></p>
<p><span>Например, TSalaried является потомком TEmployee, а TCommissioned – потомком TSalaried. Рассмотрим следующие описания:</span></p>
<p><span>var</span></p>
<p><span>AnEmрloyee: TEmployee;</span></p>
<p><span>ASalaried: TSalaried;</span></p>
<p><span>PCommissioned: TCommissioned;</span></p>
<p><span>TEmployeePtr: ^TEmployee;</span></p>
<p><span>TSalariedPtr: ^TSalaried;</span></p>
<p><span>TCommissionedPtr: ^TCommissioned;</span></p>
<p><span>При данных описаниях справедливы следующие операторы присваивания:</span></p>
<p><span>AnEmрloyee:=ASalaried;</span></p>
<p><span>ASalaried:= ACommissioned;</span></p>
<p><span>TCommissionedPtr:= ACommissioned;</span></p>
<p><span>В общем случае правило совместимости типов формулируется так: источник должен быть в состоянии полностью заполнить приемник. Порожденные типы содержат все, что содержат их порождающие типы благодаря свойству наследования. Поэтому порожденный тип имеет размер не меньший размера родителя. Присвоение порождающего объекта порожденному могло бы оставить некоторые поля порожденного объекта неопределенными, что опасно и поэтому недопустимо.</span></p>
<p><span>В операторах присваивания из источника в приемник будут копироваться только поля, являющиеся общими для обоих типов. В операторе присваивания:</span></p>
<p><span>AnEmрloyee:= ACommissioned;</span></p>
<p><span>Только поля Name, Title и Rate из ACommissionedбудут скопированы в AnEmployee, так как только эти поля являются общими для TCommissioned и TEmployee. Совместимость типов работает также между указателями на типы объектов и подчиняется тем же общим правилам, что и для реализаций объектов. Указатель на потомка может быть присвоен указателю на родителя. Если дать предыдущие определения, то следующие присваивания указателей будут допустимыми:</span></p>
<p><span>TSalariedPtr:= TCommissionedPtr;</span></p>
<p><span>TEmployeePtr:= TSalariedPtr;</span></p>
<p><span>TEmployeePtr:= PCommissionedPtr;</span></p>
<p><span>Формальный параметр (либо значение, либо параметр-переменная) данного объектного типа может принимать в качестве фактического параметра объект своего же типа или объекты всех дочерних типов. Если определить заголовок процедуры следующим образом:</span></p>
<p><span>procedure CalcFedTax(Victim: TSalaried);</span></p>
<p><span>то допустимыми типами фактических параметров могут быть TSalaried или TCommissioned, но не тип TEmployee. Victim также может быть параметром-переменной. При этом выполняются те же правила совместимости.</span></p>
<p><span>Параметр-значение является указателем на действительный, посылаемый в качестве параметра объект, а параметр-переменная является копией фактического параметра. Эта копия включает только те поля, которые входят в тип формального параметра-значения. Это означает, что фактический параметр преобразуется к типу формального параметра.</span></p>
</body></html>
