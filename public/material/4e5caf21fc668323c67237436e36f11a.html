<div class="document">




<h4></h4>

<p>

Широкое распространение реляционных СУБД и их использование в самых разнообразных приложениях показывает, что реляционная модель данных достаточна для моделирования предметных областей. Однако проектирование реляционной базы данных в терминах отношений на основе кратко рассмотренного нами механизма нормализации часто представляет собой очень сложный и неудобный для проектировщика процесс.

</p>
<p>

При этом проявляется ограниченность реляционной модели данных в следующих аспектах:

</p>
<ul type="disc">

<li>Модель не предоставляет достаточных средств для представления смысла данных. Семантика реальной предметной области должна независимым от модели способом представляться в голове проектировщика. В частности, это относится к упоминавшейся нами проблеме представления ограничений целостности.

</li>
<li>Для многих приложений трудно моделировать предметную область на основе плоских таблиц. В ряде случаев на самой начальной стадии проектирования проектировщику приходится производить насилие над собой, чтобы описать предметную область в виде одной (возможно, даже ненормализованной) таблицы.

</li>
<li>Хотя весь процесс проектирования происходит на основе учета зависимостей, реляционная модель не предоставляет каких-либо средств для представления этих зависимостей.

</li>
<li>Несмотря на то, что процесс проектирования начинается с выделения некоторых существенных для приложения объектов предметной области ("сущностей") и выявления связей между этими сущностями, реляционная модель данных не предлагает какого-либо аппарата для разделения сущностей и связей.

</li>
</ul>

<h5></h5>

<p>

Потребности проектировщиков баз данных в более удобных и мощных средствах моделирования предметной области вызвали к жизни направление семантических моделей данных. При том, что любая развитая семантическая модель данных, как и реляционная модель, включает структурную, манипуляционную и целостную части, главным назначением семантических моделей является обеспечение возможности выражения семантики данных.

</p>
<p>

Прежде, чем мы коротко рассмотрим особенности одной из распространенных семантических моделей, остановимся на их возможных применениях.

</p>
<p>

Наиболее часто на практике семантическое моделирование используется на первой стадии проектирования базы данных. При этом в терминах семантической модели производится концептуальная схема базы данных, которая затем вручную преобразуется к реляционной (или какой-либо другой) схеме. Этот процесс выполняется под управлением методик, в которых достаточно четко оговорены все этапы такого преобразования.

</p>
<p>

Менее часто реализуется автоматизированная компиляция концептуальной схемы в реляционную. При этом известны два подхода: на основе явного представления концептуальной схемы как исходной информации для компилятора и построения интегрированных систем проектирования с автоматизированным созданием концептуальной схемы на основе интервью с экспертами предметной области. И в том, и в другом случае в результате производится реляционная схема базы данных в третьей нормальной форме (более точно следовало бы сказать, что автору неизвестны системы, обеспечивающие более высокий уровень нормализации).

</p>
<p>

Наконец, третья возможность, которая еще не вышла (или только выходит) за пределы исследовательских и экспериментальных проектов, - это работа с базой данных в семантической модели, т.е. СУБД, основанные на семантических моделях данных. При этом снова рассматриваются два варианта: обеспечение пользовательского интерфейса на основе семантической модели данных с автоматическим отображением конструкций в реляционную модель данных (это задача примерно такого же уровня сложности, как автоматическая компиляция концептуальной схемы базы данных в реляционную схему) и прямая реализация СУБД, основанная на какой-либо семантической модели данных. Наиболее близко ко второму подходу находятся современные объектно-ориентированные СУБД, модели данных которых по многим параметрам близки к семантическим моделям (хотя в некоторых аспектах они более мощны, а в некоторых - более слабы).

</p>
<h5></h5>

<p>

Далее мы кратко рассмотрим некоторые черты одной из наиболее популярных семантических моделей данных - модель "Сущность-Связи" (часто ее называют кратко ER-моделью).

</p>
<p>

На использовании разновидностей ER-модели основано большинство современных подходов к проектированию баз данных (главным образом, реляционных). Модель была предложена Ченом (Chen) в 1976 г. Моделирование предметной области базируется на использовании графических диаграмм, включающих небольшое число разнородных компонентов. В связи с наглядностью представления концептуальных схем баз данных ER-модели получили широкое распространение в системах CASE, поддерживающих автоматизированное проектирование реляционных баз данных. Среди множества разновидностей ER-моделей одна из наиболее развитых применяется в системе CASE фирмы ORACLE. Ее мы и рассмотрим. Более точно, мы сосредоточимся на структурной части этой модели.

</p>
<p>

Основными понятиями ER-модели являются сущность, связь и атрибут.

</p>
<p>

Сущность - это реальный или представляемый объект, информация о котором должна сохраняться и быть доступна. В диаграммах ER-модели сущность представляется в виде прямоугольника, содержащего имя сущности. При этом имя сущности - это имя типа, а не некоторого конкретного экземпляра этого типа. Для большей выразительности и лучшего понимания имя сущности может сопровождаться примерами конкретных объектов этого типа.

</p>
<p>

Ниже изображена сущность АЭРОПОРТ с примерными объектами Шереметьево и Хитроу:

</p>
<p>

</p>
<center><img src="http://citforum.ru/database/osbd/contents.shtml../../pictures/it/osbd/img00007.gif" border="1"></center>



<p>

Каждый экземпляр сущности должен быть отличим от любого другого экземпляра той же сущности (это требование в некотором роде аналогично требованию отсутствия кортежей-дубликатов в реляционных таблицах).

</p>
<p>

Связь - это графически изображаемая ассоциация, устанавливаемая между двумя сущностями. Эта ассоциация всегда является бинарной и может существовать между двумя разными сущностями или между сущностью и ей же самой (рекурсивная связь). В любой связи выделяются два конца (в соответствии с существующей парой связываемых сущностей), на каждом из которых указывается имя конца связи, степень конца связи (сколько экземпляров данной сущности связывается), обязательность связи (т.е. любой ли экземпляр данной сущности должен участвовать в данной связи).

</p>
<p>

Связь представляется в виде линии, связывающей две сущности или ведущей от сущности к ней же самой. При это в месте "стыковки" связи с сущностью используются трехточечный вход в прямоугольник сущности, если для этой сущности в связи могут использоваться много (many) экземпляров сущности, и одноточечный вход, если в связи может участвовать только один экземпляр сущности. Обязательный конец связи изображается сплошной линией, а необязательный - прерывистой линией.

</p>
<p>

Как и сущность, связь - это типовое понятие, все экземпляры обеих пар связываемых сущностей подчиняются правилам связывания.

</p>
<p>

В изображенном ниже примере связь между сущностями БИЛЕТ и ПАССАЖИР связывает билеты и пассажиров. При том конец сущности с именем "для" позволяет связывать с одним пассажиром более одного билета, причем каждый билет должен быть связан с каким-либо пассажиром. Конец сущности с именем "имеет" означает, что каждый билет может принадлежать только одному пассажиру, причем пассажир не обязан иметь хотя бы один билет.

</p>
<p>

</p>
<center><img src="http://citforum.ru/database/osbd/contents.shtml../../pictures/it/osbd/img00008.gif" border="1"></center>



<p>

Лаконичной устной трактовкой изображенной диаграммы является следующая:

</p>
<ul type="disc">

<li>Каждый БИЛЕТ предназначен для одного и только одного ПАССАЖИРА;

</li>
<li>Каждый ПАССАЖИР может иметь один или более БИЛЕТОВ.

</li>
</ul>

<p>

На следующем примере изображена рекурсивная связь, связывающая сущность ЧЕЛОВЕК с ней же самой. Конец связи с именем "сын" определяет тот факт, что у одного отца может быть более чем один сын. Конец связи с именем "отец" означает, что не у каждого человека могут быть сыновья.

</p>
<p>

</p>
<center><img src="http://citforum.ru/database/osbd/contents.shtml../../pictures/it/osbd/img00009.gif" border="1"></center>



<p>

Лаконичной устной трактовкой изображенной диаграммы является следующая:

</p>
<ul type="disc">

<li>Каждый ЧЕЛОВЕК является сыном одного и только одного ЧЕЛОВЕКА;

</li>
<li>Каждый ЧЕЛОВЕК может являться отцом для одного или более ЛЮДЕЙ ("ЧЕЛОВЕКОВ").

</li>
</ul>

<p>

Атрибутом сущности является любая деталь, которая служит для уточнения, идентификации, классификации, числовой характеристики или выражения состояния сущности. Имена атрибутов заносятся в прямоугольник, изображающий сущность, под именем сущности и изображаются малыми буквами, возможно, с примерами.

</p>
<p>

Пример:

</p>
<p>



</p>
<p>



</p>
<p>

Уникальным идентификатором сущности является атрибут, комбинация атрибутов, комбинация связей или комбинация связей и атрибутов, уникально отличающая любой экземпляр сущности от других экземпляров сущности того же типа.

</p>
<h5></h5>

<p>

Как и в реляционных схемах баз данных, в ER-схемах вводится понятие нормальных форм, причем их смысл очень близко соответствует смыслу реляционных нормальных форм. Заметим, что формулировки нормальных форм ER-схем делают более понятным смысл нормализации реляционных схем. Мы приведем только очень краткие и неформальные определения трех первых нормальных форм.

</p>
<p>

В первой нормальной форме ER-схемы устраняются повторяющиеся атрибуты или группы атрибутов, т.е. производится выявление неявных сущностей, "замаскиро-ванных" под атрибуты.

</p>
<p>

Во второй нормальной форме устраняются атрибуты, зависящие только от части уникального идентификатора. Эта часть уникального идентификатора определяет отдельную сущность.

</p>
<p>

В третьей нормальной форме устраняются атрибуты, зависящие от атрибутов, не входящих в уникальный идентификатор. Эти атрибуты являются основой отдельной сущности.

</p>
<h5></h5>

<p>

Мы остановились только на самых основных и наиболее очевидных понятиях ER-модели данных. К числу более сложных элементов модели относятся следующие:

</p>
<ul type="disc">

<li>Подтипы и супертипы сущностей. Как в языках программирования с развитыми типовыми системами (например, в языках объектно-ориентированного программирования), вводится возможность наследования типа сущности, исходя из одного или нескольких супертипов. Интересные нюансы связаны с необходимостью графического изображения этого механизма.

</li>
<li>Связи "many-to-many". Иногда бывает необходимо связывать сущности таким образом, что с обоих концов связи могут присутствовать несколько экземпляров сущности (например, все члены кооператива сообща владеют имуществом кооператива). Для этого вводится разновидность связи "многие-со-многими".

</li>
<li>Уточняемые степени связи. Иногда бывает полезно определить возможное количество экземпляров сущности, участвующих в данной связи (например, служащему разрешается участвовать не более, чем в трех проектах одновременно). Для выражения этого семантического ограничения разрешается указывать на конце связи ее максимальную или обязательную степень.

</li>
<li>Каскадные удаления экземпляров сущностей. Некоторые связи бывают настолько сильными (конечно, в случае связи "один-ко-многим"), что при удалении опорного экземпляра сущности (соответствующего концу связи "один") нужно удалить и все экземпляры сущности, соответствующие концу связи "многие". Соответствующее требование "каскадного удаления" можно сформулировать при определении сущности.

</li>
<li>Домены. Как и в случае реляционной модели данных бывает полезна возможность определения потенциально допустимого множества значений атрибута сущности (домена).

</li>
</ul>

<p>

Эти и другие более сложные элементы модели данных "Сущность-Связи" делают ее существенно более мощной, но одновременно несколько усложняют ее использование. Конечно, при реальном использовании ER-диаграмм для проектирования баз данных необходимо ознакомиться со всеми возможностями.

</p>
<p>

В нашей лекции мы немного подробнее разберем только один из упомянутых элементов - подтип сущности.

</p>
<p>

Сущность может быть расщеплена на два или более взаимно исключающих подтипа, каждый из которых включает общие атрибуты и/или связи. Эти общие атрибуты и/или связи явно определяются один раз на более высоком уровне. В подтипах могут определяться собственные атрибуты и/или связи. В принципе подтипизация может продолжаться на более низких уровнях, но опыт показывает, что в большинстве случаев оказывается достаточно двух-трех уровней.

</p>
<p>

Сущность, на основе которой определяются подтипы, называется супертипом. Подтипы должны образовывать полное множество, т.е. любой экземпляр супертипа должен относиться к некоторому подтипу. Иногда для полноты приходится определять дополнительный подтип ПРОЧИЕ.

</p>
<p>

Пример: Супертип ЛЕТАТЕЛЬНЫЙ АППАРАТ

</p>
<p>

</p>
<center><img src="http://citforum.ru/database/osbd/contents.shtml../../pictures/it/osbd/img00010.gif" border="1"></center>



<p>

Как полагается это читать? От супертипа: ЛЕТАТЕЛЬНЫЙ АППАРАТ, который должен быть АЭРОПЛАНОМ, ВЕРТОЛЕТОМ, ПТИЦЕЛЕТОМ или ДРУГИМ ЛЕТАТЕЛЬНЫМ АППАРАТОМ. От подтипа: ВЕРТОЛЕТ, который относится к типу ЛЕТАТЕЛЬНОГО АППАРАТА. От подтипа, который является одновременно супертипа: АЭРОПЛАН, который относится к типу ЛЕТАТЕЛЬНОГО АППАРАТА и должен быть ПЛАНЕРОМ или МОТОРНЫМ САМОЛЕТОМ.

</p>
<p>

Иногда удобно иметь два или более разных разбиения сущности на подтипы. Например, сущность ЧЕЛОВЕК может быть разбита на подтипы по профессиональному признаку (ПРОГРАММИСТ, ДОЯРКА и т.д.), а может - по половому признаку (МУЖЧИНА, ЖЕНЩИНА).

</p>
<h5></h5>

<p>

<b>Шаг 1.</b> Каждая простая сущность превращается в таблицу. Простая сущность - сущность, не являющаяся подтипом и не имеющая подтипов. Имя сущности становится именем таблицы.

</p>
<p>

<b>Шаг 2.</b> Каждый атрибут становится возможным столбцом с тем же именем; может выбираться более точный формат. Столбцы, соответствующие необязательным атрибутам, могут содержать неопределенные значения; столбцы, соответствующие обязательным атрибутам, - не могут.

</p>
<p>

<b>Шаг 3.</b> Компоненты уникального идентификатора сущности превращаются в первичный ключ таблицы. Если имеется несколько возможных уникальных идентификатора, выбирается наиболее используемый. Если в состав уникального идентификатора входят связи, к числу столбцов первичного ключа добавляется копия уникального идентификатора сущности, находящейся на дальнем конце связи (этот процесс может продолжаться рекурсивно). Для именования этих столбцов используются имена концов связей и/или имена сущностей.

</p>
<p>

<b>Шаг 4.</b> Связи многие-к-одному (и один-к-одному) становятся внешними ключами. Т.е. делается копия уникального идентификатора с конца связи "один", и соответствующие столбцы составляют внешний ключ. Необязательные связи соответствуют столбцам, допускающим неопределенные значения; обязательные связи - столбцам, не допускающим неопределенные значения.

</p>
<p>

<b>Шаг 5.</b> Индексы создаются для первичного ключа (уникальный индекс), внешних ключей и тех атрибутов, на которых предполагается в основном базировать запросы.

</p>
<p>

<b>Шаг 6.</b> Если в концептуальной схеме присутствовали подтипы, то возможны два способа:

</p>
<ul type="disc">

<li>все подтипы в одной таблице (а)

</li>
<li>для каждого подтипа - отдельная таблица (б)

</li>
</ul>

<p>

При применении способа (а) таблица создается для наиболее внешнего супертипа, а для подтипов могут создаваться представления. В таблицу добавляется по крайней мере один столбец, содержащий код ТИПА; он становится частью первичного ключа.

</p>
<p>

При использовании метода (б) для каждого подтипа первого уровня (для более нижних - представления) супертип воссоздается с помощью представления UNION (из всех таблиц подтипов выбираются общие столбцы - столбцы супертипа).



</p>
<table border="1" width="100%">
<tr>
<td align="center" colspan="90"><b>Все в одной таблице</b></td>
<td align="center" colspan="69">
<b>Таблица - на подтип</b>

</td>
</tr>
<tr><td align="center" colspan="159">
<i>Преимущества</i>

</td></tr>
<tr>
<td colspan="90">Все хранится вместеЛегкий доступ к супертипу и подтипамТребуется меньше таблиц</td>
<td colspan="69">Более ясны правила подтиповПрограммы работают только с нужными таблицами

</td>
</tr>
<tr><td align="center" colspan="159">
<i>Недостатки</i>

</td></tr>
<tr>
<td colspan="90">Слишком общее решениеТребуется дополнительная логика работы с разными наборами столбцов и разными ограничениямиПотенциальное узкое место (в связи с блокировками)Столбцы подтипов должны быть необязательнымиВ некоторых СУБД для хранения неопределенных значений требуется дополнительная память</td>
<td colspan="69">Слишком много таблицСмущающие столбцы в представлении UNIONПотенциальная потеря производительности при работе через UNIONНад супертипом невозможны модификации

</td>
</tr>
</table>

<p>

<b>Шаг 7.</b> Имеется два способа работы при наличии исключающих связей:

</p>
<ul type="disc">

<li>общий домен (а)

</li>
<li>явные внешние ключи (б)

</li>
</ul>

<p>

Если остающиеся внешние ключи все в одном домене, т.е. имеют общий формат (способ (а)), то создаются два столбца: идентификатор связи и идентификатор сущности. Столбец идентификатора связи используется для различения связей, покрываемых дугой исключения. Столбец идентификатора сущности используется для хранения значений уникального идентификатора сущности на дальнем конце соответствующей связи.

</p>
<p>

Если результирующие внешние ключи не относятся к одному домену, то для каждой связи, покрываемой дугой исключения, создаются явные столбцы внешних ключей; все эти столбцы могут содержать неопределенные значения.



</p>
<table border="1" width="100%">
<tr>
<td align="center" colspan="82"><b>Общий домен</b></td>
<td align="center" colspan="77">
<b>Явные внешние ключи</b>

</td>
</tr>
<tr><td align="center" colspan="159">
<i>Преимущества</i>

</td></tr>
<tr>
<td colspan="82">Нужно только два столбца</td>
<td colspan="77">Условия соединения - явные

</td>
</tr>
<tr><td align="center" colspan="159">
<i>Недостатки</i>

</td></tr>
<tr>
<td colspan="82">Оба дополнительных атрибута должны использоваться в соединениях</td>
<td colspan="77">Слишком много столбцов

</td>
</tr>
</table>

<p>



</p>
<p>

<i>Альтернативные модели сущностей:</i>

</p>
<p>

Вариант 1 (плохой)



</p>
<center><img src="http://citforum.ru/database/osbd/contents.shtml../../pictures/it/osbd/img00011.gif" border="1"></center>



<p>

Вариант 2 (существенно лучше, если подтипы действительно существуют)



<img src="http://citforum.ru/database/osbd/contents.shtml../../pictures/it/osbd/img00012.gif" border="1">



</p>
<p>

Вариант 3 (годится при наличии осмысленного супертипа D).



</p>
<center><img src="http://citforum.ru/database/osbd/contents.shtml../../pictures/it/osbd/img00013.gif" border="1"></center>





<p></p>
<center> ||  || <p>

</p>
<p></p>
</center>
</div>